webpackJsonp([12],{eJA9:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAABHNCSVQICAgIfAhkiAAAAihJREFUSEvtls112lAQhb9rJG9DKgipIOogpgLDInCyCunArsC4giQVmKx8wAtwBSEdKBWEVBCytYQn5wmJg0AghL3KiZZ6d+bOz31vRhzyja1ee+Bc0BIEiEZiZswMQoPJ4pR72pqXuVMZwL+zCzOuBPV9WIO5oB919GUfbjfh2OpexFhwljkwuMeSjEL3L802EJyvYaaxT3tXtjsJvZFNBW+XleN7vKDHe80Ko7+1hldjsIafxh01i7CFhN7Q+hJXaZ++Rl31ykrvzv2hDRAfkiCN67ir/qbdNuGylD+Tnhk/oq6CQ8gyjD+0EPHG9TT2eb1Z2i3C2sh6J3DjHDwa7UVXkyqEtaG1TsQ4sYePi44G6/Z5wpEFnlOkaKW9WwmmCqlgmpZ1EotrOkpElgoNXFQSN2XSr0KawxqzR7h01ZJ3Z2cyvh3trIKhiabW5V/B9iiou17yR2ZVrF2UORFUrE5lwqijnNCqBvyfcKu9/2hJxWU2kuJ3Sl6R7HP3OH1BAoxPZYo/SDSRz8vSaT62uh/x+1kIgTDyae4kXZK516p0shyUYRp1MWkFsqT0FS9uGC1oryb/rTX8WjKKSjNbTYuKhG7dmJvo8YiOmTCFGRr8iRcEO3eYMmUsd5xQ8GIT6qaFW+9yB1kWMkr3zCJuE3VZslTlVkuXiCOcrK95ZcE/5dytmWJP+k9xvmmbtWk5apy0H/iMkqX31XMSAb8wptEpF+4e/wUqkQAQ5rwH7QAAAABJRU5ErkJggg=="},ekOu:function(e,t,a){var i=a("rWyu");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("rjj0")("2a1b9760",i,!0)},rWyu:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"\nul li[data-v-381c8151] {\n  list-style: none;\n}\n[data-v-381c8151] .el-form-item {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  margin-right: 14px;\n}\n[data-v-381c8151] .el-form-item__content {\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  width: 100%;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n[data-v-381c8151] .el-form-item__label {\n  min-width: 75px;\n}\n.row-width-auto-margin-0-90[data-v-381c8151] {\n  width: auto;\n  margin: auto 5%;\n}\n.searchCont[data-v-381c8151] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  max-width: 740px;\n  margin: 0 auto;\n}\n.searchCont[data-v-381c8151] .el-input__inner {\n  height: 100%;\n  border-radius: 0;\n  border: 1px solid #05AAFF;\n}\n.searchCont .el-input[data-v-381c8151] {\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n}\n.searchCont .btn[data-v-381c8151] {\n  border: 0;\n  border-radius: 0;\n}\n.searchCont .addBtn[data-v-381c8151] {\n  margin-left: 45px;\n}\n.searchCont .el-button[data-v-381c8151] {\n  width: 120px;\n}\n.hotSearch[data-v-381c8151] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  max-width: 740px;\n  margin: 0 auto;\n}\n.hotSearch p[data-v-381c8151] {\n  font-size: 12px;\n  color: #042B40;\n}\n.hotSearch span[data-v-381c8151] {\n  font-size: 12px;\n  color: #979797;\n  margin-right: 18px;\n}\n.box-card[data-v-381c8151] {\n  margin-bottom: 14px;\n}\n.bt_blue[data-v-381c8151] {\n  width: 120px;\n  height: 48px;\n  background: -webkit-gradient(linear, left top, left bottom, from(#69ccff), to(#05aaff));\n  background: linear-gradient(180deg, #69ccff 0%, #05aaff 100%);\n  opacity: 1;\n  border-radius: 2px;\n}\n[data-v-381c8151] .el-card__header {\n  padding: 10px 20px;\n}\n.headerTop[data-v-381c8151] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n}\n.headerLeft[data-v-381c8151] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.headerLeft span[data-v-381c8151] {\n  font-size: 14px;\n  color: rgba(68, 68, 68, 0.75);\n}\n.headerLeft span span[data-v-381c8151] {\n  color: #F56C6C;\n}\n.headerLeft .headBtn[data-v-381c8151] {\n  margin-left: 40px;\n}\n.headerLeft .headBtn .allChoose[data-v-381c8151] {\n  padding: 6px 8px;\n  font-size: 16px;\n  color: #05AAFF;\n  border: 1px solid #05AAFF;\n  background-color: #fff;\n  border-radius: 2px;\n}\n.headerLeft .headBtn .allDelete[data-v-381c8151] {\n  padding: 6px 8px;\n  font-size: 16px;\n  color: #fff;\n  border: 1px solid #FF8585;\n  background-color: #FF8585;\n  border-radius: 2px;\n}\n.headerRig[data-v-381c8151] .el-select .el-input__inner {\n  border: none;\n}\n.cardCont[data-v-381c8151] .el-card__body {\n  padding: 0;\n}\n.dataList .dataBox[data-v-381c8151] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  padding: 23px 30px;\n  border-bottom: 1px solid rgba(68, 68, 68, 0.14901961);\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n}\n.dataList .dataBox .dataBoxLeft .dataLeft[data-v-381c8151] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n.dataList .dataBox .dataBoxLeft .dataLeft .fileType[data-v-381c8151] {\n  font-size: 18px;\n  width: 60px;\n  height: 60px;\n  opacity: 1;\n  border-radius: 2px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  color: #fff;\n  margin-right: 30px;\n}\n.dataList .dataBox .dataBoxLeft .dataLeft .fileDoc[data-v-381c8151] {\n  background: #69ccff;\n}\n.dataList .dataBox .dataBoxLeft .dataLeft .fileXls[data-v-381c8151] {\n  background: #91E5A1;\n}\n.dataList .dataBox .dataBoxLeft .dataLeft .filePpt[data-v-381c8151] {\n  background: #FFCBA6;\n}\n.dataList .dataBox .dataBoxLeft .dataLeft .filePdf[data-v-381c8151] {\n  background: #FF8585;\n}\n.dataList .dataBox .dataBoxLeft .dataLeft .fileJpg[data-v-381c8151] {\n  background: #9BB5FF;\n}\n.dataList .dataBox .dataBoxLeft .dataLeft .filePng[data-v-381c8151] {\n  background: #FE95B2;\n}\n.dataList .dataBox .dataBoxLeft .dataLeft .dataDetail p[data-v-381c8151] {\n  font-size: 18px;\n  font-weight: bold;\n  color: #444444;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.dataList .dataBox .dataBoxLeft .dataLeft .dataDetail p span[data-v-381c8151] {\n  width: auto;\n  min-width: 45px;\n  max-width: 700px;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n}\n.dataList .dataBox .dataBoxLeft .dataLeft .dataDetail .down-img[data-v-381c8151] {\n  cursor: pointer;\n  margin-left: 12px;\n}\n.dataList .dataBox .dataBoxLeft .dataLeft .dataDetail .dataMsg[data-v-381c8151] {\n  font-size: 14px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  color: #444;\n  margin-top: 16px;\n  -ms-flex-wrap: wrap;\n      flex-wrap: wrap;\n}\n.dataList .dataBox .dataBoxLeft .dataLeft .dataDetail .dataMsg span[data-v-381c8151] {\n  margin-right: 60px;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n  width: auto;\n  min-width: 45px;\n  max-width: 500px;\n}\n.dataList .dataBox .dataBoxRig .primary[data-v-381c8151] {\n  border: 1px solid #05aaff;\n  color: #05AAFF;\n}\n.dataList .dataBox .dataBoxRig .primary[data-v-381c8151]:hover {\n  background: #05aaff;\n  color: #fff;\n}\n.dataList .dataBox .dataBoxRig .btnMt[data-v-381c8151] {\n  margin-bottom: 5px;\n}\n[data-v-381c8151] .el-dialog__header {\n  border-bottom: 1px solid #ddd;\n  background: -webkit-gradient(linear, left top, left bottom, from(#69ccff), to(#05aaff));\n  background: linear-gradient(180deg, #69ccff 0%, #05aaff 100%);\n  opacity: 1;\n  padding: 10px 10px;\n}\n[data-v-381c8151] .el-dialog__header .el-dialog__title {\n  color: #fff;\n  font-size: 14px;\n}\n[data-v-381c8151] .el-dialog__header .el-dialog__headerbtn {\n  top: 15px;\n  background: #fff;\n  border-radius: 100%;\n  width: 15px;\n  height: 15px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\n[data-v-381c8151] .el-dialog__header .el-dialog__headerbtn .el-dialog__close {\n  font-size: 12px;\n  color: #05AAFF;\n  margin-top: 2px;\n}\n.noMore[data-v-381c8151] {\n  text-align: center;\n  padding: 20px 0;\n}\n.main-list[data-v-381c8151] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n.main-list .left-file[data-v-381c8151] {\n  width: 20%;\n  min-width: 200px;\n  height: 500px;\n  margin-right: 10px;\n}\n.main-list .left-file .header-file-top[data-v-381c8151] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n}\n.main-list .left-file .header-file-top .icon-file[data-v-381c8151] {\n  cursor: pointer;\n}\n.main-list .left-file[data-v-381c8151] .el-card__header {\n  padding: 15px 10px;\n}\n.main-list .left-file .mulu[data-v-381c8151] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n.main-list .left-file .mulu li[data-v-381c8151] {\n  cursor: pointer;\n}\n.main-list .left-file[data-v-381c8151] .el-card__body {\n  height: 453px;\n  overflow-y: auto;\n}\n.main-list .box-card[data-v-381c8151] {\n  width: 100%;\n}\n.file-list[data-v-381c8151] {\n  margin-left: 9px;\n}\n.file-list .icon-del-file[data-v-381c8151] {\n  color: red;\n  cursor: pointer;\n}\n.tree-list[data-v-381c8151] .el-tree-node__label {\n  text-overflow: ellipsis;\n  overflow: hidden;\n}\n",""])},zF2U:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("mvHQ"),s=a.n(i),l=a("/jS7"),n=a("Q5rI"),o=a("jlNU"),r=a("gu65"),d={data:function(){var e=this;return{btnFlag:0,fileForm:{fileName:"",page:0,pageSize:200,orderField:"",orderType:"",folderId:"",companyId:this.$store.getters.companyId},rules:{fileName:[{required:!0,message:"请上传文件",trigger:"blur"}],folderId:[{required:!0,message:"请选择文件分类",trigger:"blur"}],oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"}],password:[{min:6,max:16,message:"密码长度不能小于6位，不能大于16位",trigger:"blur"}],confirmPassword:[{validator:function(t,a,i){e.folderMgtDto.password&&""===a?i(new Error("请输入新密码")):e.folderMgtDto.password&&a!==e.folderMgtDto.password?i(new Error("两次输入密码不一致!")):i()},trigger:"blur"},{min:6,max:16,message:"密码长度不能小于6位，不能大于16位",trigger:"blur"}]},checkList:[],fileList:[],dialogVisible:!1,typeList:[],folderMgtDto:{page:0,pageSize:1e3,folderId:"",fileName:"",fileDesc:""},limitNum:1,upFileLoad:!1,fileTemp:"",isEdit:!1,orderList:[{label:"分类名升序",value:"folderName",type:"ASC",id:1},{label:"分类名降序",value:"folderName",type:"DESC",id:2},{label:"上传日期顺序",value:"createTime",type:"ASC",id:5},{label:"上传日期倒序",value:"createTime",type:"DESC",id:6}],fileDataList:[],value:"",total:0,isAll:!1,treeParam:{page:0,pageSize:100},treeData:[],tempChildData:[],treePath:{},isTreePath:!1,filesList:[],activeTreeData:{},isEditModal:!0,filePathName:"",allowAdd:this.authorityControl("SYSTEM:FILE:MANAGE","SYSTEM:FILE:LIBRARY","SYSTEM:FILE:LIBRARY:INSERT"),allowDetail:this.authorityControl("SYSTEM:FILE:MANAGE","SYSTEM:FILE:LIBRARY","SYSTEM:FILE:LIBRARY:DETAILS"),allowDownload:this.authorityControl("SYSTEM:FILE:MANAGE","SYSTEM:FILE:LIBRARY","SYSTEM:FILE:LIBRARY:DOWNLOAD"),allowUpdate:this.authorityControl("SYSTEM:FILE:MANAGE","SYSTEM:FILE:LIBRARY","SYSTEM:FILE:LIBRARY:UPDATE"),allowDelete:this.authorityControl("SYSTEM:FILE:MANAGE","SYSTEM:FILE:LIBRARY","SYSTEM:FILE:LIBRARY:DELETE"),allowGetList:this.authorityControl("SYSTEM:FILE:MANAGE","SYSTEM:FILE:LIBRARY","SYSTEM:FILE:LIBRARY:LIST"),allowExport:this.authorityControl("SYSTEM:FILE:MANAGE","SYSTEM:FILE:LIBRARY","SYSTEM:FILE:LIBRARY:EXPORT"),allowFileType:this.authorityControl("SYSTEM:FILE:MANAGE","SYSTEM:FILE:FILECLASS"),allowSetPassword:this.authorityControl("SYSTEM:FILE:MANAGE","SYSTEM:FILE:LIBRARY","SYSTEM:FILE:LIBRARY:SETPASSWORD")}},mounted:function(){this.getTreeData(),this.getFileList()},activated:function(){window.addEventListener("scroll",this.scrollToTop)},destroyed:function(){clearInterval(this.timer),window.removeEventListener("scroll",this.scrollToTop)},props:{changeOnSelect:{default:!1}},methods:{backTop:function(){var e=this,t=setInterval(function(){var a=Math.floor(-e.scrollTop/5);document.documentElement.scrollTop=document.body.scrollTop=e.scrollTop+a,0===e.scrollTop&&clearInterval(t)},16)},scrollToTop:function(){var e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;this.scrollTop=e,this.scrollTop>0?this.btnFlag=!0:this.btnFlag=!1},getFileList:function(){var e=this;this.allowGetList.twoAllow?Object(l.j)(this.fileForm).then(function(t){200==t.code?(e.fileForm.page>0?e.fileDataList=e.fileDataList.concat(t.data.data):(e.fileDataList=t.data.data,e.checkList=[]),e.total=t.data.total):e.$message.warning(t.message)}):this.$message.warning("抱歉，您没有权限获取此列表")},goSearch:function(){this.fileForm.page=0,this.getFileList()},getMore:function(){this.fileForm.page=this.fileForm.page+20,this.getFileList()},deleteFile:function(e,t){var a=this;if(""!=e&&void 0!=e){var i=[];if(0==t){var s={fileId:e.fileId,folderId:e.folderId};i.push(s)}else e.forEach(function(e){a.fileDataList.forEach(function(t){if(e==t.fileId){var a={fileId:t.fileId,folderId:t.folderId};i.push(a)}})});0!=i.length&&""!=i?this.$confirm("是否确定删除","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={companyId:a.$store.getters.companyId,fileList:i};Object(l.d)(e).then(function(e){200==e.code?0==e.data?(a.$message.success("某些文件没有删除权限，只删除了有权限的文件"),a.getFileList()):(a.$message.success("删除成功"),a.getFileList()):a.$message.warning(e.message)})}):this.$message.warning("请选择需要删除的文件")}else this.$message.warning("请选择需要删除的文件")},openAddFile:function(){this.getCateList(),this.isEditModal=!1,this.dialogVisible=!0},handleClose:function(e){this.dialogVisible=!1,this.folderMgtDto={page:1,pageSize:1e3,folderId:"",fileName:"",fileDesc:""},this.filesList=[],this.isEdit&&(this.isEdit=!this.isEdit)},openEdit:function(e,t){var a=this;this.getCateList(),this.isEditModal=!0,this.isEdit=!0;var i={fileId:t,companyId:this.$store.getters.companyId};this.allowDetail.twoAllow?Object(l.h)(i).then(function(e){200==e.code?(a.filesList.push(e.data),a.folderMgtDto=e.data,a.filePathName=e.data.parentFolderName.join("/")):a.$message.warning(e.message)}):this.$message.warning("抱歉，您没有权限获取此详情"),this.dialogVisible=!0},getCateList:function(){var e=this;Object(l.k)(this.folderMgtDto).then(function(t){200==t.code?e.typeList=t.data.data.map(function(e){return e.label=e.folderName,e.value=e.folderId,e.child=[],e}):e.$message({type:"error",message:t.message})})},UploadUrl:function(){return"/api/filelibrary/appFile/uploadFile"},beforeUploadFile:function(e){e.name.substring(e.name.lastIndexOf(".")+1);var t=e.size/1024/1024;this.fileTemp="",this.fileList=[],t>10&&(this.$message.warning("文件大小不得超过10M"),this.fileTemp="",this.fileList=[])},fileChange:function(e,t){this.fileTemp="",this.folderMgtDto.fileName="",this.fileList=[];var a=e.raw.name.substr(e.raw.name.lastIndexOf("."));e.name.length>=150?this.$message("文件名称超长，请检查"):".msi"!=a?".vbs"!=a?".cmd"!=a?".bat"!=a?".scr"!=a?".reg"!=a?".obj"!=a?".ddl"!=a?".sys"!=a?".apk"!=a?".o"!=a?".c"!=a?".h"!=a?".sh"!=a?".so"!=a?".out"!=a?".coff"!=a?"text/javascript"!=e.raw.type?"application/x-msdownload"!=e.raw.type&&"application/x-msdownload"!=e.raw.type?(this.fileTemp=e.raw,this.fileTemp?(this.folderMgtDto.fileName=e.name,this.importMaterielList(this.fileTemp)):(this.$message({type:"warning",message:"请上传文件！"}),this.fileTemp="",this.fileList=[])):this.$message({type:"warning",message:"不支持上传exe文件"}):this.$message({type:"warning",message:"不支持上传js文件"}):this.$message({type:"warning",message:"不支持上传coff文件"}):this.$message({type:"warning",message:"不支持上传out文件"}):this.$message({type:"warning",message:"不支持上传so文件"}):this.$message({type:"warning",message:"不支持上传sh文件"}):this.$message({type:"warning",message:"不支持上传h文件"}):this.$message({type:"warning",message:"不支持上传c文件"}):this.$message({type:"warning",message:"不支持上传o文件"}):this.$message({type:"warning",message:"不支持上传apk文件"}):this.$message({type:"warning",message:"不支持上传sys文件"}):this.$message({type:"warning",message:"不支持上传ddl文件"}):this.$message({type:"warning",message:"不支持上传obj文件"}):this.$message({type:"warning",message:"不支持上传reg文件"}):this.$message({type:"warning",message:"不支持上传scr文件"}):this.$message({type:"warning",message:"不支持上传bat文件"}):this.$message({type:"warning",message:"不支持上传cmd文件"}):this.$message({type:"warning",message:"不支持上传vbs文件"}):this.$message({type:"warning",message:"不支持上传msi文件"})},exceedFile:function(e,t){this.$message.warning("只能选择 "+this.limitNum+" 个文件，当前共选择了 "+(e.length+t.length)+" 个")},importMaterielList:function(e){this.fileTemp=e},submit:function(e){var t=this;this.$refs[e].validate(function(e){if(e){if(0==t.filesList.length)return void t.$message.warning("请选择文件");var a=t.filesList[0],i=new FormData;i.append("fileDesc",t.folderMgtDto.fileDesc),i.append("fileId",a.fileId),i.append("filePath",a.filePath),i.append("fileName",a.fileName),i.append("fileType",a.fileType),i.append("fileSize",a.fileSize/1024),i.append("folderId",t.activeTreeData.folderId),i.append("folderName",t.activeTreeData.folderName),i.append("parentType",3),i.append("password",t.folderMgtDto.password?t.folderMgtDto.password:""),t.upFileLoad=!0,Object(l.b)(i).then(function(e){200==e.code?(t.upFileLoad=!1,t.$message({type:"success",message:"提交成功！"}),t.getFileList(),t.fileTemp="",t.filesList=[],t.folderMgtDto={page:1,pageSize:1e3,folderId:"",fileName:"",fileDesc:""},t.dialogVisible=!1):(t.upFileLoad=!1,t.$message({type:"error",message:e.message}))})}})},editFile:function(e){var t=this;this.$refs[e].validate(function(e){if(e){if(0==t.filesList.length)return void t.$message.warning("请选择文件");var a=t.filesList[0],i=new FormData;i.append("companyId",t.$store.getters.companyId),i.append("fileDesc",t.folderMgtDto.fileDesc),i.append("fileId",t.folderMgtDto.fileId),i.append("filePath",a.filePath),i.append("fileName",a.fileName),i.append("fileType",a.fileType),i.append("fileSize",a.fileSize/1024),i.append("folderId",t.folderMgtDto.folderId),i.append("folderName",t.folderMgtDto.folderName),i.append("parentType",3),i.append("password",t.folderMgtDto.password?t.folderMgtDto.password:""),t.upFileLoad=!0,Object(l.o)(i).then(function(e){200==e.code?(t.upFileLoad=!1,t.$message({type:"success",message:"修改成功！"}),t.getFileList(),t.fileTemp="",t.filesList=[],t.folderMgtDto={page:1,pageSize:1e3,folderId:"",fileName:"",fileDesc:""},t.dialogVisible=!1,t.isEdit=!1):(t.upFileLoad=!1,t.$message({type:"error",message:e.message}))})}})},downloadFile:function(e){var t=this,a={companyId:this.$store.getters.companyId,fileId:e.fileId};e&&e.password&&e.password.length>0?this.$prompt("请输入密码","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(i){i.value!==e.password?t.$message({type:"info",message:"密码错误"}):t.handleDownloadFile(a)}).catch(function(){t.$message({type:"info",message:"取消下载"})}):this.handleDownloadFile(a)},handleDownloadFile:function(e){var t=this;Object(l.i)(e).then(function(e){if(200===e.code){var a=e.data.fileUrl.replace(/http/,"https");window.open(a),t.$message({type:"success",message:"下载成功"})}else t.$message({type:"error",message:e.message})})},handledSelect:function(e){var t=this;""==e?(this.fileForm.orderField="",this.fileForm.orderType=""):this.orderList.forEach(function(a){a.id==e&&(t.fileForm.orderField=a.value,t.fileForm.orderType=a.type)}),this.getFileList()},cancelDio:function(){this.dialogVisible=!1,this.fileTemp="",this.filesList=[],this.folderMgtDto={page:1,pageSize:1e3,folderId:"",fileName:"",fileDesc:""},this.isEdit&&(this.isEdit=!this.isEdit)},allCheck:function(){var e=this;this.isAll?(this.checkList=[],this.isAll=!this.isAll):(this.checkList=[],this.fileDataList.forEach(function(t){e.checkList.push(t.fileId)}),this.isAll=!this.isAll)},getTreeData:function(){var e=this;Object(l.k)(this.treeParam).then(function(t){200===t.code&&(e.treeData=t.data.data.map(function(e){return e.label=e.folderName,e.children=[{}],e}))})},getChildData:function(e,t){var a=this;this.treeParam.parentId=e.folderId,e&&e.password&&e.password.length>0?this.$prompt("请输入密码","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(i){i.value!==e.password?a.$message({type:"info",message:"密码错误"}):a.handleGetChildData(e,t)}).catch(function(){a.$message({type:"info",message:"取消打开目录"})}):this.handleGetChildData(e,t)},handleGetChildData:function(e,t){var a=this;Object(l.k)(this.treeParam).then(function(t){200===t.code&&(0==t.data.data.length?(a.$message.warning("当前目录下没有子目录"),a.$refs.tree.store.nodesMap[e.folderId].expanded=!1):e.children=t.data.data.map(function(e){return e.label=e.folderName,e.children=[{}],e}))})},nodeHandle:function(e,t){this.fileForm.folderId=e.folderId,this.activeTreeData.folderId=e.folderId,this.activeTreeData.folderName=e.folderName,0!=e.parentId?(this.activeTreeData.parentFolderName=t.parent.data.folderName,this.activeTreeData.parentFolderId=t.parent.data.folderId):(this.activeTreeData.parentFolderName="",this.activeTreeData.parentFolderId=""),this.getFileList(),this.treePath=t,this.isTreePath=!0},masterPathHandle:function(){this.treeParam={page:0,pageSize:100},this.fileForm={fileName:"",page:0,pageSize:200,orderField:"",orderType:"",folderId:"",companyId:this.$store.getters.companyId},this.getTreeData(),this.getFileList(),this.treePath={},this.activeTreeData={}},parentHandle:function(e){this.$refs.tree.setCurrentKey(e.data.folderId),this.fileForm.folderId=e.data.folderId,this.getFileList(),this.treePath=e},handleFilesUpload:function(e){var t=this;if(e.file.name.length>=150)return this.$message.error("文件名称超长，请检查"),void(this.declareFileList=JSON.parse(s()(this.declareFileList)));var a=e.file.name.lastIndexOf("."),i=e.file.name.substring(0,a),l=e.file.name.substring(a+1,e.file.name.length),d=void 0;if(this.isEditModal){if(0!==this.folderMgtDto.parentFolderName.length){if(!this.activeTreeData.parentFolderName||""==this.activeTreeData.parentFolderName)return this.$message.error("文件夹名称为空，请检查"),void(this.declareFileList=JSON.parse(s()(this.declareFileList)));if(1==this.folderMgtDto.parentFolderName.length)d=Object(r.d)(this.folderMgtDto.parentFolderName[0],"",i)+"."+l;else{var c=JSON.parse(s()(this.folderMgtDto.parentFolderName));c.splice(0,1),c.length>1?(c.join("/"),d=Object(r.d)(this.folderMgtDto.parentFolderName[0],c,i)+"."+l):d=Object(r.d)(this.folderMgtDto.parentFolderName[0],c[0],i)+"."+l}}}else if(this.activeTreeData.parentFolderName&&""!==this.activeTreeData.parentFolderName){if(!this.activeTreeData.parentFolderName||""==this.activeTreeData.parentFolderName)return this.$message.error("文件夹名称为空，请检查"),void(this.declareFileList=JSON.parse(s()(this.declareFileList)));d=Object(r.d)(this.activeTreeData.parentFolderName,this.activeTreeData.folderName,i)+"."+l}else{if(!this.activeTreeData.folderName||""==this.activeTreeData.folderName)return this.$message.error("文件夹名称为空，请检查"),void(this.declareFileList=JSON.parse(s()(this.declareFileList)));d=Object(r.d)(this.activeTreeData.folderName,"",i)+"."+l}var f=e.file.size/1024;return f>this.$store.getters.singleCapacity?(this.$message.error("文件大小超出限制，上传失败"),void(this.declareFileList=JSON.parse(s()(this.declareFileList)))):f>this.$store.getters.totalCapacity?(this.$message.error("文件大小超出容量剩余空间，上传失败"),void(this.declareFileList=JSON.parse(s()(this.declareFileList)))):void Object(o.a)(d,e.file,e).then(function(a){if(a){var i=[],o={fileName:e.file.name,filePath:d,fileSize:f,fileType:l,parentType:4};i.push(o);var r={companyId:t.$store.getters.companyId,companyName:t.$store.getters.companyName,addFileDtos:i,haveView:!1};Object(n.a)(r).then(function(e){200==e.code?(t.$message.success("上传成功"),t.filesList=e.data):(t.$message.error("上传失败，请检查重新上传"),t.declareFileList=JSON.parse(s()(t.declareFileList)))})}else t.$message.error("文件出错或文件已存在，无法覆盖"),t.declareFileList=JSON.parse(s()(t.declareFileList))})},delFileHandle:function(e){this.filesList.splice(e,1)},goFileType:function(){this.$router.push({path:"/file/fileType"})}}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"row-width-auto-margin-0-90"},[i("el-card",{staticClass:"box-card"},[i("div",{staticClass:"searchCont"},[i("el-input",{attrs:{placeholder:"请输入文件名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.goSearch(t)}},model:{value:e.fileForm.fileName,callback:function(t){e.$set(e.fileForm,"fileName",t)},expression:"fileForm.fileName"}}),e._v(" "),i("el-button",{staticClass:"btn bt_blue",attrs:{type:"primary"},on:{click:e.goSearch}},[i("span",{staticClass:"bt_font"},[e._v("搜一下")])])],1)]),e._v(" "),i("div",{staticClass:"main-list"},[i("el-card",{staticClass:"left-file"},[i("div",{staticClass:"header-file-top",attrs:{slot:"header"},slot:"header"},[i("div",{staticStyle:{display:"flex","align-items":"center","font-size":"13px","white-space":"nowrap","text-overflow":"ellipsis",overflow:"hidden"}},[i("div",{staticStyle:{cursor:"pointer"},on:{click:e.masterPathHandle}},[e._v("根目录 /")]),e._v(" "),e.treePath.data&&0==e.treePath.data.parentId?i("div",{staticStyle:{cursor:"pointer"}},[i("span",{attrs:{title:e.treePath.data.folderName}},[e._v(e._s(e.treePath.data.folderName))])]):i("div",{staticStyle:{display:"flex",width:"100%","text-overflow":"ellipsis",overflow:"hidden","white-space":"nowrap"}},[e.treePath.parent&&""!==e.treePath.parent.data.folderName?i("div",{staticStyle:{cursor:"pointer"},on:{click:function(t){return e.parentHandle(e.treePath.parent)}}},[i("span",{attrs:{title:e.treePath.parent.data.folderName}},[e._v(e._s(e.treePath.parent.data.folderName))])]):e._e(),e._v(" "),e.treePath.data&&""!==e.treePath.data.folderName?i("div",{staticStyle:{cursor:"pointer",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},[e._v("\n                /"),i("span",{attrs:{title:e.treePath.data.folderName}},[e._v(e._s(e.treePath.data.folderName))])]):e._e()])]),e._v(" "),e.allowFileType?i("i",{staticClass:"icon-file el-icon-folder-opened",on:{click:e.goFileType}}):e._e()]),e._v(" "),i("div",[i("el-tree",{ref:"tree",staticClass:"tree-list",attrs:{data:e.treeData,"node-key":"folderId","highlight-current":!0,"expand-on-click-node":!1},on:{"node-expand":e.getChildData,"node-click":e.nodeHandle},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.node;return t.data,i("span",{staticStyle:{"text-overflow":"ellipsis",overflow:"hidden"}},[i("span",{attrs:{title:a.label}},[e._v(e._s(a.label))])])}}])})],1)]),e._v(" "),i("el-card",{staticClass:"box-card cardCont"},[i("div",{staticClass:"headerTop",attrs:{slot:"header"},slot:"header"},[i("div",{staticClass:"headerLeft"},[i("span",[e._v("搜索到"),i("span",[e._v(e._s(e.total))]),e._v("条记录")]),e._v(" "),e.checkList.length>0?i("span",{staticStyle:{"margin-left":"10px"}},[e._v("已选中"),i("span",[e._v(e._s(e.checkList.length))]),e._v("条记录")]):e._e(),e._v(" "),i("div",{staticClass:"headBtn"},[i("el-button",{staticClass:"btn allChoose",attrs:{type:"primary",size:"small"},on:{click:e.allCheck}},[e._v("全选")]),e._v(" "),e.allowDelete.twoAllow?i("el-button",{staticClass:"btn allDelete",attrs:{size:"small"},on:{click:function(t){return e.deleteFile(e.checkList,1)}}},[e._v("删除\n              ")]):e._e(),e._v(" "),e.activeTreeData.folderId&&""!==e.activeTreeData.folderId&&e.allowAdd.twoAllow?i("el-button",{staticClass:"btn allChoose",attrs:{type:"primary"},on:{click:e.openAddFile}},[e._v("\n                新增\n              ")]):e._e()],1)]),e._v(" "),i("div",{staticClass:"headerRig"},[i("el-select",{attrs:{placeholder:"默认排序",clearable:""},on:{change:e.handledSelect},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.orderList,function(e){return i("el-option",{key:e.id,attrs:{label:e.label,value:e.id}})}),1)],1)]),e._v(" "),i("div",{staticClass:"dataList"},[i("el-checkbox-group",{model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},e._l(e.fileDataList,function(t,s){return i("div",{key:t.fileId,staticClass:"dataBox"},[i("div",{staticClass:"dataBoxLeft"},[i("el-checkbox",{attrs:{label:t.fileId}},[i("div",{staticClass:"dataLeft"},[i("div",{staticClass:"fileType fileDoc",class:"docx"==t.fileType?"fileDoc":"xlsx"==t.fileType?"fileXls":"ppt"==t.fileType?"filePpt":"pdf"==t.fileType?"filePdf":"jpg"==t.fileType||"jpeg"==t.fileType?"fileJpg":"png"==t.fileType?"filePng":"fileDoc"},[e._v("\n                      ."+e._s(t.fileType)+"\n                    ")]),e._v(" "),i("div",{staticClass:"dataDetail"},[i("p",[i("span",{attrs:{title:t.fileName}},[e._v(e._s(t.fileName))]),e._v(" "),e.allowDownload.twoAllow&&t.password&&t.password.length>0?i("img",{staticClass:"down-img",attrs:{src:a("eJA9")},on:{click:function(a){return e.downloadFile(t)}}}):e.allowDownload.twoAllow?i("img",{staticClass:"down-img",attrs:{src:a("LiIp")},on:{click:function(a){return e.downloadFile(t)}}}):e._e()]),e._v(" "),i("div",{staticClass:"dataMsg"},[i("span",[e._v("文件分类："+e._s(t.folderName))]),e._v(" "),i("span",[e._v("上传日期："+e._s(t.createTime))]),e._v(" "),i("span",[e._v("上传人："+e._s(t.uploadUserName))]),e._v(" "),i("span",{attrs:{title:t.fileDesc}},[e._v("备注："+e._s(t.fileDesc))])])])])])],1),e._v(" "),i("div",{staticClass:"dataBoxRig"},[e.allowUpdate.twoAllow?i("div",{staticClass:"btnMt"},[i("el-button",{staticClass:"primary",attrs:{plain:"",icon:"el-icon-edit",size:"small"},on:{click:function(a){return e.openEdit(t,t.fileId)}}},[e._v("编辑\n                  ")])],1):e._e(),e._v(" "),e.allowDelete.twoAllow?i("div",{staticClass:"btnMt"},[i("el-button",{attrs:{type:"danger",plain:"",icon:"el-icon-delete",size:"small"},on:{click:function(a){return e.deleteFile(t,0)}}},[e._v("删除\n                  ")])],1):e._e()])])}),0)],1),e._v(" "),e.total-e.fileDataList.length>0?i("div",{staticClass:"noMore",staticStyle:{cursor:"pointer"},on:{click:e.getMore}},[e._v("\n          点击加载更多\n        ")]):i("div",{staticClass:"noMore"},[e._v("\n          没有更多\n        ")])])],1),e._v(" "),i("div",{staticStyle:{height:"60px",position:"fixed",bottom:"20px",right:"0",width:"80px"}},[e.btnFlag?i("a",{attrs:{href:"javascript:",target:"_self"},on:{click:e.backTop}},[i("img",{attrs:{src:a("1XGe"),alt:""}})]):e._e()])],1),e._v(" "),i("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:e.isEditModal?"编辑文件":"新建文件",visible:e.dialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("div",[i("el-form",{ref:"folderMgtDto",staticClass:"demo-ruleForm",attrs:{model:e.folderMgtDto,rules:e.rules}},[i("el-form-item",{attrs:{label:"文件分类:"}},[e.isEditModal?i("div",[e._v("\n            "+e._s(e.filePathName)+"\n          ")]):i("div",[""==e.activeTreeData.parentFolderName?i("span",[e._v(e._s(e.activeTreeData.folderName))]):i("span",[e._v(e._s(e.activeTreeData.parentFolderName)+"/"+e._s(e.activeTreeData.folderName))])])]),e._v(" "),i("el-form-item",[i("div",{staticStyle:{"font-weight":"bold"}},[i("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 文件上传:")]),e._v(" "),0!==e.filesList.length?i("ul",{staticClass:"file-list"},e._l(e.filesList,function(t,a){return i("li",[e._v("\n              "+e._s(t.fileName)+"\n            ")])}),0):e._e(),e._v(" "),i("el-upload",{staticClass:"image-uploader",attrs:{"http-request":e.handleFilesUpload,"file-list":e.filesList,"show-file-list":!1,action:""}},[i("el-button",{staticStyle:{"margin-left":"10px","margin-right":"36px"},attrs:{size:"small",type:"primary",disabled:e.upFileLoad}},[e._v("文件上传")])],1),e._v(" "),i("p",{staticStyle:{"margin-bottom":"10px","font-size":"12px",color:"#ff3f4b","line-height":"normal"}},[e._v("限制文件不超过"+e._s(e.$store.getters.singleCapacity/1024+"M"))])],1),e._v(" "),e.allowSetPassword.twoAllow?i("span",[i("el-form-item",{attrs:{label:"新密码:",prop:"password"}},[i("el-input",{staticClass:"searchInput",attrs:{type:"password",size:"small",rows:3,placeholder:"请输入新密码",maxLength:"100"},model:{value:e.folderMgtDto.password,callback:function(t){e.$set(e.folderMgtDto,"password",t)},expression:"folderMgtDto.password"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"确认密码:",prop:"confirmPassword"}},[i("el-input",{staticClass:"searchInput",attrs:{type:"password",size:"small",rows:3,placeholder:"请输入确认密码",maxLength:"100"},model:{value:e.folderMgtDto.confirmPassword,callback:function(t){e.$set(e.folderMgtDto,"confirmPassword",t)},expression:"folderMgtDto.confirmPassword"}})],1)],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"备注:",prop:"fileDesc"}},[i("el-input",{staticClass:"searchInput",attrs:{size:"small",rows:3,placeholder:"备注",maxLength:"1000","show-word-limit":""},model:{value:e.folderMgtDto.fileDesc,callback:function(t){e.$set(e.folderMgtDto,"fileDesc",t)},expression:"folderMgtDto.fileDesc"}})],1)],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.cancelDio}},[e._v("取 消")]),e._v(" "),e.isEdit?i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.editFile("folderMgtDto")}}},[e._v("修 改")]):i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit("folderMgtDto")}}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var f=a("VU/8")(d,c,!1,function(e){a("ekOu")},"data-v-381c8151",null);t.default=f.exports}});