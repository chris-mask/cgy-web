webpackJsonp([43],{"8bXw":function(e,a,t){(e.exports=t("FZ+f")(!0)).push([e.i,"\n.box-card[data-v-3bc627da] {\n  margin-bottom: 10px;\n}\n.headerLeft[data-v-3bc627da] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.headerLeft .conditionChoose[data-v-3bc627da] {\n  font-size: 16px;\n  color: #444 !important;\n}\n.headerLeft .conditionChoose[data-v-3bc627da]::before {\n  content: '';\n  border-left: 2px solid #03adf4;\n  margin-right: 15px;\n}\n.headerLeft .condOring[data-v-3bc627da]::before {\n  content: '';\n  border-left: 2px solid #ffa01c;\n  margin-right: 15px;\n}\n.payName[data-v-3bc627da] {\n  font-size: 14px;\n  display: inline-block;\n}\n.payName span[data-v-3bc627da] {\n  color: #69ccff;\n  margin-right: 10px;\n}\n.el-row[data-v-3bc627da] {\n  margin-bottom: 15px;\n}\n.el-row[data-v-3bc627da]:last-child {\n  margin-bottom: 0;\n}\n[data-v-3bc627da] .el-card__header {\n  padding: 12px 13px;\n}\n[data-v-3bc627da] .el-input {\n  width: auto;\n}\n[data-v-3bc627da] .el-select {\n  display: inline-block !important;\n}\n.btnList[data-v-3bc627da] {\n  text-align: center;\n}\n","",{version:3,sources:["H:/java/chengguoyun-web/src/views/contractManage/paymentRecordDetail.vue"],names:[],mappings:";AACA;EACE,oBAAoB;CACrB;AACD;EACE,qBAAqB;EACrB,qBAAqB;EACrB,cAAc;EACd,0BAA0B;MACtB,uBAAuB;UACnB,oBAAoB;CAC7B;AACD;EACE,gBAAgB;EAChB,uBAAuB;CACxB;AACD;EACE,YAAY;EACZ,+BAA+B;EAC/B,mBAAmB;CACpB;AACD;EACE,YAAY;EACZ,+BAA+B;EAC/B,mBAAmB;CACpB;AACD;EACE,gBAAgB;EAChB,sBAAsB;CACvB;AACD;EACE,eAAe;EACf,mBAAmB;CACpB;AACD;EACE,oBAAoB;CACrB;AACD;EACE,iBAAiB;CAClB;AACD;EACE,mBAAmB;CACpB;AACD;EACE,YAAY;CACb;AACD;EACE,iCAAiC;CAClC;AACD;EACE,mBAAmB;CACpB",file:"paymentRecordDetail.vue",sourcesContent:["\n.box-card[data-v-3bc627da] {\n  margin-bottom: 10px;\n}\n.headerLeft[data-v-3bc627da] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.headerLeft .conditionChoose[data-v-3bc627da] {\n  font-size: 16px;\n  color: #444 !important;\n}\n.headerLeft .conditionChoose[data-v-3bc627da]::before {\n  content: '';\n  border-left: 2px solid #03adf4;\n  margin-right: 15px;\n}\n.headerLeft .condOring[data-v-3bc627da]::before {\n  content: '';\n  border-left: 2px solid #ffa01c;\n  margin-right: 15px;\n}\n.payName[data-v-3bc627da] {\n  font-size: 14px;\n  display: inline-block;\n}\n.payName span[data-v-3bc627da] {\n  color: #69ccff;\n  margin-right: 10px;\n}\n.el-row[data-v-3bc627da] {\n  margin-bottom: 15px;\n}\n.el-row[data-v-3bc627da]:last-child {\n  margin-bottom: 0;\n}\n[data-v-3bc627da] .el-card__header {\n  padding: 12px 13px;\n}\n[data-v-3bc627da] .el-input {\n  width: auto;\n}\n[data-v-3bc627da] .el-select {\n  display: inline-block !important;\n}\n.btnList[data-v-3bc627da] {\n  text-align: center;\n}\n"],sourceRoot:""}])},NJwx:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=t("mvHQ"),o=t.n(r),s=t("woOf"),n=t.n(s),i=t("l8D1"),l=t("c8+v"),c=t("Q5rI"),d=t("jlNU"),m=t("gu65"),p={activated:function(){this.recordForm={},this.isCheck=this.$route.query.isCheck,this.recordForm.recordId=this.$route.query.recordId,this.recordForm.recordId&&this.getDetail(),this.getPersonList("业务员,业务主管")},data:function(){return{recordForm:{},fileForm:{},paymentLevelList:[{label:"国家级",value:"1"},{label:"省级",value:"2"},{label:"市级",value:"3"},{label:"区县级",value:"4"},{label:"镇街级",value:"5"}],isCheck:!1,fileList:[],recheckFileList:[],dialogVisible:!1,payMethods:[]}},methods:{getDetail:function(){var e=this;Object(i.q)({recordId:this.recordForm.recordId}).then(function(a){if(200==a.code){if(n()(e.recordForm,a.data.crmContractVo,a.data.crmCustomerVo,a.data.orderDetailVo,a.data.paymentRecordVo),e.recordForm=JSON.parse(o()(e.recordForm)),e.recordForm.basisFileIds&&""!=e.recordForm.basisFileIds){var t=[e.recordForm.basisFileIds];e.getFileDetail(t,1)}if(e.recordForm.recheckFileIds&&""!=e.recordForm.recheckFileIds){var r=[e.recordForm.recheckFileIds];e.getFileDetail(r,2)}e.getPaymentData(a.data.paymentRecordVo.orderId)}})},getFileDetail:function(e,a){var t=this;Object(c.k)({fileIds:e,haveView:!0}).then(function(e){200==e.code?(1==a&&(t.fileList=e.data.map(function(e){return e.name=e.fileName,e}),t.$set(t.fileForm,"file",e.data[0]),t.$set(t.fileForm,"fileIds",e.data[0].fileId),t.$set(t.fileForm,"fileName",e.data[0].fileName),t.$set(t.fileForm,"fileUrl",e.data[0].fileUrl)),2==a&&(t.recheckFileList=e.data.map(function(e){return e.name=e.fileName,e}),t.$set(t.recordForm,"file",e.data[0]),t.$set(t.recordForm,"fileIds",e.data[0].fileId),t.$set(t.recordForm,"fileName",e.data[0].fileName),t.$set(t.recordForm,"fileUrl",e.data[0].fileUrl))):t.$message.warning(e.message)})},downloadFile:function(e){e.filePath&&Object(c.p)(e).then(function(e){200==e.code&&window.open(e.data)})},getPersonList:function(e,a){var t=this,r=new FormData;r.append("roleNameList",e),void 0!=a&&r.append("deptIdList",a),Object(l.D)(r).then(function(e){200==e.code?t.userList=e.data:t.$message.warning(e.message)})},openEdit:function(){this.isCheck=!0},editPayment:function(){var e=this;Object(i.B)(this.recordForm).then(function(a){200==a.code&&(e.$message.success("修改成功"),e.recordForm={},e.fileList=[],e.recheckFileList=[],e.$store.commit("SET_CONTRACT_SCROLL",0),e.closeCurrent(e.$store.state.tagsView.visitedViews,e.$route,"/contract"))})},openRecheck:function(){this.dialogVisible=!0},recheckPayment:function(e){var a=this;this.$confirm("你确定审核吗？确定后即可生效","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.recordForm.recheckResult=e,Object(i.C)(a.recordForm).then(function(e){200==e.code&&(a.$message({type:"success",message:"审核成功"}),a.dialogVisible=!1,a.closeCurrent(a.$store.state.tagsView.visitedViews,a.$route,"/contract"))})}).catch(function(e){})},handleExceed:function(e,a){this.$message.warning("当前限制选择 1 个文件，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+a.length)+" 个文件")},uploadBeforeFile:function(e){var a="image/jpeg"===e.type||"image/png"===e.type,t=e.size/1024/1024<100;return t||this.$message.error("上传文件大小不能超过 100MB!"),a||this.$message.error("上传头像图片只能是 JPG或者png 格式!"),a&&t},handleUpload:function(e){var a=this;if(e.file.name.length>=150)return this.$message.error("文件名称超长，请检查"),void(this.recheckFileList=JSON.parse(o()(this.recheckFileList)));var t=e.file.name.split("."),r=Object(m.i)(this.recordForm.crmCompanyName,this.recordForm.projectName,"其他资料",t[0])+"."+t[t.length-1];Object(d.a)(r,e.file,e).then(function(o){if(o){var s=[],n={fileName:e.file.name,filePath:r,fileSize:e.file.size,fileType:t[t.length-1],parentType:4};s.push(n);var i={companyId:a.recordForm.crmCompanyId,companyName:a.recordForm.crmCompanyName,addFileDtos:s,haveView:!0};Object(c.a)(i).then(function(e){200==e.code&&(a.$message.success("上传成功"),a.$set(a.recordForm,"recheckFileIds",e.data[0].fileId),a.$set(a.recordForm,"fileName",e.data[0].fileName),a.$set(a.recordForm,"fileUrl",e.data[0].fileUrl))})}})},cancelSub:function(){this.closeCurrent(this.$store.state.tagsView.visitedViews,this.$route,"/contract")},inputXz:function(e){e.target.value>=9999999&&(e.target.value=9999999),""!=e&&(e.target.value=e.target.value.match(/^\d*(\.?\d{0,2})/g)[0]||null)},getPaymentData:function(e){var a=this,t={options:[]},r={options:[]};Object(i.p)({orderId:e}).then(function(e){200===e.code&&e.data.forEach(function(e){e.paymentModeType?(t.lable="历史回款阶段",t.options.push(e),a.$set(a.payMethods,0,t)):(r.lable="",r.options.push(e),a.$set(a.payMethods,1,r))})})}}},v={render:function(){var e=this,a=e.$createElement,r=e._self._c||a;return r("div",{staticClass:"app-container"},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"headerTop",attrs:{slot:"header"},slot:"header"},[r("div",{staticClass:"headerLeft"},[r("span",{staticClass:"conditionChoose"},[e._v("回款详情")])])]),e._v(" "),r("div",{staticClass:"paymentCont"},[r("el-row",[r("el-col",{attrs:{span:12}},[r("p",{staticClass:"payName"},[e._v("\n              客户名称：\n              "),r("span",[e._v(e._s(e.recordForm.crmCompanyName))]),e._v(" "),e.isCheck||0!=e.recordForm.recheckResult?e._e():r("img",{staticStyle:{"vertical-align":"middle","margin-left":"3px",cursor:"pointer"},attrs:{src:t("qzBd")},on:{click:e.openEdit}})])]),e._v(" "),r("el-col",{attrs:{span:12}},[r("p",{staticClass:"payName"},[e._v("客户类别："),r("span",[e._v(e._s(e.recordForm.companyLevelName))])])])],1)],1)]),e._v(" "),r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"headerTop",attrs:{slot:"header"},slot:"header"},[r("div",{staticClass:"headerLeft"},[r("span",{staticClass:"conditionChoose condOring"},[e._v("合同信息")])])]),e._v(" "),r("div",{staticClass:"paymentCont"},[r("el-row",[r("el-col",{attrs:{span:8}},[r("p",{staticClass:"payName"},[e._v("合同编号："),r("span",[e._v(e._s(e.recordForm.contractCode))])])]),e._v(" "),r("el-col",{attrs:{span:8}},[r("p",{staticClass:"payName"},[e._v("创建日期："+e._s(e.recordForm.createDate))])]),e._v(" "),r("el-col",{attrs:{span:8}},[r("p",{staticClass:"payName"},[e._v("有效期："+e._s(e.recordForm.availableYear+"年"))])])],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:8}},[r("p",{staticClass:"payName"},[e._v("签订人："),r("span",[e._v(e._s(e.recordForm.signUserName))])])]),e._v(" "),r("el-col",{attrs:{span:8}},[r("p",{staticClass:"payName"},[e._v("签约日期："+e._s(e.recordForm.signDate))])]),e._v(" "),r("el-col",{attrs:{span:8}},[r("p",{staticClass:"payName"},[e._v("签约公司："+e._s(e.recordForm.signCompanyName))])])],1)],1)]),e._v(" "),r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"headerTop",attrs:{slot:"header"},slot:"header"},[r("div",{staticClass:"headerLeft"},[r("span",{staticClass:"conditionChoose condOring"},[e._v("项目信息")])])]),e._v(" "),r("div",{staticClass:"paymentCont"},[r("el-row",[r("el-col",{attrs:{span:12}},[r("p",{staticClass:"payName"},[e._v("项目名称："),r("span",[e._v(e._s(e.recordForm.projectName))])])]),e._v(" "),r("el-col",{attrs:{span:12}},[r("p",{staticClass:"payName"},[e._v("工程师："),r("span",[e._v(e._s(e.recordForm.engineerUserName))])])])],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:6}},[r("p",{staticClass:"payName"},[e._v("年份："+e._s(e.recordForm.year))])]),e._v(" "),r("el-col",{attrs:{span:6}},[r("p",{staticClass:"payName"},[e._v("批次：\n              "+e._s(0==e.recordForm.batch?"未指定":1==e.recordForm.batch?"第一批":2==e.recordForm.batch?"第二批":3==e.recordForm.batch?"第三批":4==e.recordForm.batch?"第四批":5==e.recordForm.batch?"第五批":"-"))])]),e._v(" "),r("el-col",{attrs:{span:6}},[r("p",{staticClass:"payName"},[e._v("数量："+e._s(e.recordForm.applyNum))])])],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:6}},[r("p",{staticClass:"payName"},[e._v("批准金额：")]),e._v(" "),e.isCheck?r("el-input",{attrs:{type:"number",size:"small",maxlength:"7",oninput:"value=value.replace(/[^0-9.]/g,'');"},nativeOn:{input:function(a){return e.inputXz(a)}},model:{value:e.recordForm.approvalMoney,callback:function(a){e.$set(e.recordForm,"approvalMoney",a)},expression:"recordForm.approvalMoney"}},[r("template",{slot:"append"},[e._v("元")])],2):r("p",{staticClass:"payName"},[e._v(e._s(e.recordForm.approvalMoney+"元"))])],1)],1)],1)]),e._v(" "),r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"headerTop",attrs:{slot:"header"},slot:"header"},[r("div",{staticClass:"headerLeft"},[r("span",{staticClass:"conditionChoose condOring"},[e._v("回款信息")])])]),e._v(" "),r("div",{staticClass:"paymentCont"},[r("el-row",[r("el-col",{attrs:{span:5}},[r("p",{staticClass:"payName"},[e._v("汇款日期：")]),e._v(" "),e.isCheck?r("el-date-picker",{attrs:{size:"small",type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.recordForm.paymentDate,callback:function(a){e.$set(e.recordForm,"paymentDate",a)},expression:"recordForm.paymentDate"}}):r("p",{staticClass:"payName"},[r("span",[e._v(e._s(e.recordForm.paymentDate))])])],1),e._v(" "),r("el-col",{attrs:{span:5}},[r("p",{staticClass:"payName"},[e._v("回款金额/比例：")]),e._v(" "),e.isCheck?r("el-input",{attrs:{size:"small",type:"number",maxlength:"7",oninput:"value=value.replace(/[^0-9.]/g,'');"},nativeOn:{input:function(a){return e.inputXz(a)}},model:{value:e.recordForm.paymentAmount,callback:function(a){e.$set(e.recordForm,"paymentAmount",a)},expression:"recordForm.paymentAmount"}},[r("template",{slot:"append"},[e._v("元")])],2):r("p",{staticClass:"payName"},[e._v(e._s(e.recordForm.paymentAmount+"元"))])],1),e._v(" "),r("el-col",{attrs:{span:5}},[r("p",{staticClass:"payName"},[e._v("回款阶段：")]),e._v(" "),e.isCheck?r("el-select",{attrs:{placeholder:"回款阶段",clearable:"",size:"small"},model:{value:e.recordForm.paymentType,callback:function(a){e.$set(e.recordForm,"paymentType",a)},expression:"recordForm.paymentType"}},e._l(e.payMethods,function(a){return r("el-option-group",{key:a.lable,attrs:{label:a.lable}},e._l(a.options,function(e){return r("el-option",{key:e.paymentMode,attrs:{label:e.paymentModeName,value:e.paymentMode}})}),1)}),1):r("p",{staticClass:"payName"},[e._v("\n              "+e._s(0==e.recordForm.paymentType?"签约后":1==e.recordForm.paymentType?"受理后":2==e.recordForm.paymentType?"完成（提交）后":3==e.recordForm.paymentType?"立项公示后":4==e.recordForm.paymentType?"拨付后":5==e.recordForm.paymentType?"验收后":6==e.recordForm.paymentType?"收到通知书后":"-")+"\n            ")])],1),e._v(" "),r("el-col",{attrs:{span:5}},[r("p",{staticClass:"payName"},[e._v("财政级别：")]),e._v(" "),e.isCheck?r("el-select",{attrs:{placeholder:"财政级别",clearable:"",size:"small"},model:{value:e.recordForm.paymentLevel,callback:function(a){e.$set(e.recordForm,"paymentLevel",a)},expression:"recordForm.paymentLevel"}},e._l(e.paymentLevelList,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1):r("p",{staticClass:"payName"},[e._v("\n              "+e._s(1==e.recordForm.paymentLevel?"国家级":2==e.recordForm.paymentLevel?"省级":3==e.recordForm.paymentLevel?"市级":4==e.recordForm.paymentLevel?"区县级":5==e.recordForm.paymentLevel?"镇街级":"-")+"\n            ")])],1),e._v(" "),r("el-col",{attrs:{span:4}},[r("p",{staticClass:"payName"},[e._v("收款人：")]),e._v(" "),e.isCheck?r("el-select",{attrs:{placeholder:"收款人",clearable:"",size:"small"},model:{value:e.recordForm.paymentUserId,callback:function(a){e.$set(e.recordForm,"paymentUserId",a)},expression:"recordForm.paymentUserId"}},e._l(e.userList,function(e){return r("el-option",{key:e.userId,attrs:{label:e.userName,value:e.userId}})}),1):r("p",{staticClass:"payName"},[e._v(e._s(e.recordForm.paymentUserName))])],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:5}},[r("p",{staticClass:"payName"},[e._v("录入日期："+e._s(e.recordForm.entryDate))])])],1)],1)]),e._v(" "),r("el-card",{staticClass:"box-card"},[e.recordForm.file?r("p",{staticClass:"payName"},[e._v("\n        我是凭证：\n        "),r("span",{staticStyle:{cursor:"pointer"},on:{click:function(a){return e.downloadFile(e.recordForm.file)}}},[e._v(e._s(e.recordForm.file.fileName))])]):e._e(),e._v(" "),r("p",{staticClass:"payName"},[e._v("\n        回款依据：\n        "),r("span",{staticStyle:{cursor:"pointer"},on:{click:function(a){return e.downloadFile(e.fileForm.file)}}},[e._v(e._s(e.fileForm.file.fileName))])]),e._v(" "),r("p",[r("img",{staticStyle:{"max-width":"100%","margin-top":"10px"},attrs:{src:e.recordForm.fileUrl,alt:""}})])]),e._v(" "),r("div",{staticClass:"btnList"},[e.isCheck&&e.recordForm.recordId&&0==e.recordForm.recheckResult?r("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.editPayment}},[e._v("提交")]):e._e(),e._v(" "),e.recordForm.recordId&&0==e.recordForm.recheckResult?r("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.openRecheck}},[e._v("审核")]):e._e(),e._v(" "),r("el-button",{attrs:{size:"small"},on:{click:e.cancelSub}},[e._v("取消")])],1),e._v(" "),r("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"审核",visible:e.dialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(a){e.dialogVisible=a}}},[r("div",{staticStyle:{display:"flex"}},[r("span",[e._v("上传凭证：")]),e._v(" "),r("el-upload",{staticClass:"image-uploader",attrs:{"http-request":e.handleUpload,"before-upload":e.uploadBeforeFile,"file-list":e.recheckFileList,limit:1,"on-exceed":e.handleExceed,action:""}},[r("el-button",{staticClass:"btn export",attrs:{type:"primary",size:"small"}},[e._v("上传")])],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"small"},on:{click:function(a){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),e.recordForm.recordId&&0==e.recordForm.recheckResult?r("el-button",{attrs:{size:"small",type:"info"},on:{click:function(a){return e.recheckPayment(2)}}},[e._v("不通过")]):e._e(),e._v(" "),e.recordForm.recordId&&0==e.recordForm.recheckResult?r("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return e.recheckPayment(1)}}},[e._v("通过")]):e._e()],1)])],1)},staticRenderFns:[]};var u=t("VU/8")(p,v,!1,function(e){t("dZiK")},"data-v-3bc627da",null);a.default=u.exports},dZiK:function(e,a,t){var r=t("8bXw");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);t("rjj0")("dd5ec394",r,!0)}});
//# sourceMappingURL=43.95982d9bb7f0645206c0.js.map