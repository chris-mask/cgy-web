webpackJsonp([130],{XHd2:function(e,t,a){var n=a("l7cA");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("rjj0")("02975752",n,!0)},l7cA:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,'\n.star[data-v-198e906b] {\n  color: #ff3d4c !important;\n  position: absolute;\n  left: -8px;\n}\n.class-newPlan[data-v-198e906b] {\n  background: #2979ff;\n  color: #fff;\n  border-radius: 5px;\n  width: 100px;\n  height: 25px;\n  line-height: 25px;\n  text-align: center;\n  margin-bottom: 10px;\n}\n.get-more[data-v-198e906b] {\n  text-align: center;\n  margin-top: 10px;\n}\n.editorUserModal[data-v-198e906b] .el-dialog__header {\n  border-bottom: 1px solid rgba(68, 68, 68, 0.3);\n  padding: 20px 20px 16px;\n}\n.editorUserModal[data-v-198e906b] .el-dialog__title {\n  line-height: 0;\n}\n.editorUserModal[data-v-198e906b] .el-dialog__headerbtn {\n  top: 19px;\n}\n.editorUserModal[data-v-198e906b] .el-dialog__body {\n  padding: 14px;\n}\n.editorUserModal[data-v-198e906b] .el-form-item__label {\n  font-weight: normal;\n  color: rgba(68, 68, 68, 0.75);\n}\n.editorUserModal[data-v-198e906b] .el-form-item__content {\n  width: 73%;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n.editorUserModal .user-input[data-v-198e906b] .el-input__inner {\n  border: 0;\n  border-radius: 0;\n  border-bottom: 1px solid rgba(68, 68, 68, 0.3);\n}\n.editorUserModal .user-input.input[data-v-198e906b] {\n  width: 100%;\n  border-radius: 0;\n  border: 0;\n  border-bottom: 1px solid rgba(68, 68, 68, 0.3);\n}\n.editorUserModal .user-input.input[data-v-198e906b]:focus {\n  border: 0;\n  border-bottom: 1px solid rgba(68, 68, 68, 0.3);\n}\n.editorUserModal .user-select[data-v-198e906b] {\n  width: 100%;\n}\n.editorUserModal .switch-btn[data-v-198e906b] {\n  font-size: 14px;\n  color: #fff;\n  background: #05aaff;\n  margin-left: 10px;\n}\n.editorUserModal .switch-btn[data-v-198e906b]:active {\n  opacity: 0.5;\n}\n.editorUserModal .modal-radio[data-v-198e906b] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.editorUserModal .modal-radio[data-v-198e906b] .el-form-item__content {\n  margin-left: 0 !important;\n}\n.editorUserModal .dialog-footer .setBtn[data-v-198e906b] {\n  color: #fff;\n  background: #05aaff;\n}\n.editorUserModal .dialog-footer .cananl[data-v-198e906b] {\n  background: #fff;\n  color: #444444;\n}\n.user-conent[data-v-198e906b] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  padding: 10px 10px 0;\n}\n.user-conent .check-input[data-v-198e906b] {\n  width: 18px;\n  height: 18px;\n  cursor: pointer;\n  margin-right: 5px;\n  border: 1px solid rgba(68, 68, 68, 0.15);\n}\n.user-conent .check-input[type="checkbox"][data-v-198e906b] {\n  background-color: #05AAFF !important;\n}\n.user-conent .index[data-v-198e906b] {\n  background: #FFCBA6;\n  border-radius: 2px;\n  width: 18px;\n  min-width: 18px;\n  height: 18px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  color: #fff;\n  margin-right: 4px;\n}\n.user-conent .item[data-v-198e906b] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -ms-flex-wrap: wrap;\n      flex-wrap: wrap;\n  padding: 0;\n  font-size: 14px;\n  border-bottom: 0;\n}\n.user-conent .item .cate[data-v-198e906b] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  width: 33%;\n  min-width: 25%;\n  color: rgba(68, 68, 68, 0.75);\n  margin-bottom: 12px;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n}\n.user-conent .item .cate span[data-v-198e906b] {\n  color: #444444;\n  text-overflow: ellipsis;\n  overflow: hidden;\n}\n.user-conent .item .cate .blue[data-v-198e906b] {\n  color: #05aaff;\n  cursor: pointer;\n}\n.user-conent .item .cate.results[data-v-198e906b] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n.user-conent .item .cate.results .tit[data-v-198e906b] {\n  font-style: normal;\n  white-space: nowrap;\n}\n.user-conent .item .cate.results span[data-v-198e906b] {\n  width: 400px;\n  display: inline-block;\n  word-wrap: break-word;\n  word-break: normal;\n}\n@media screen and (max-width: 1450px) {\n.user-conent .item .cate[data-v-198e906b] {\n    min-width: 50%;\n}\n}\n.user-conent .main-list[data-v-198e906b] {\n  width: 80%;\n}\n.user-conent .bage-btn-handle[data-v-198e906b] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: end;\n      -ms-flex-pack: end;\n          justify-content: flex-end;\n}\n@media screen and (max-width: 1250px) {\n.user-conent .bage-btn-handle[data-v-198e906b] {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -ms-flex-wrap: wrap;\n        flex-wrap: wrap;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n}\n}\n.user-conent[data-v-198e906b]:nth-child(even) {\n  background: #EFFAFF;\n}\n.user-conent[data-v-198e906b]:nth-child(odd) {\n  background: #F1F4FF;\n}\n.bage[data-v-198e906b] {\n  min-width: 118px;\n  margin-right: 30px;\n}\n.handle-btn-group[data-v-198e906b] {\n  width: 153px;\n  min-width: 153px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-wrap: wrap;\n      flex-wrap: wrap;\n  height: 72px;\n}\n.handle-btn-group .item-btn[data-v-198e906b] {\n  width: 72px;\n  min-width: 72px;\n  height: 30px;\n  background-image: url('+a("EL+u")+");\n  cursor: pointer;\n  background-size: cover;\n}\n.handle-btn-group .item-btn.read[data-v-198e906b] {\n  background-position: 1px, 0;\n  margin-right: 5px;\n}\n.handle-btn-group .item-btn.implement[data-v-198e906b] {\n  background-position: -79px, 0;\n}\n.handle-btn-group .item-btn.edit[data-v-198e906b] {\n  background-position: -158px, 0;\n  margin-right: 5px;\n}\n.handle-btn-group .item-btn.remark[data-v-198e906b] {\n  background-position: -237px, 0;\n}\n.handle-btn-group .item-btn.again[data-v-198e906b] {\n  background: none;\n  font-size: 14px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  border: 1px solid #444;\n  border-radius: 2px;\n}\n.handle-btn-group .item-btn[data-v-198e906b]:hover {\n  background-image: url("+a("7bFG")+");\n}\n.handle-btn-group .item-btn:hover.again[data-v-198e906b] {\n  background: none;\n  background: #444;\n  color: #fff;\n}\n",""])},v2Ch:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("mvHQ"),o=a.n(n),i=a("bOdI"),l=a.n(i),s=(a("Q5rI"),a("ZWSL"),a("AvzY")),r=(a("IcnI"),a("rN1C"),{props:{id:{type:String},companyNames:{type:String},crmCompanyId:{type:String},powerEdit:{type:Boolean}},data:function(){var e;return e={patentType:[],listQuery:{},salePlanBos:[],newly:"https://chengguoyun.oss-cn-shenzhen.aliyuncs.com/新开发_20200514212127_390.png",existing:"https://chengguoyun.oss-cn-shenzhen.aliyuncs.com/已有客户(1)_20200514212222_746.png",unenforced:"https://chengguoyun.oss-cn-shenzhen.aliyuncs.com/抢客户图案_20200514212701_500.png",executeTypeList:{0:"其他",1:"电话",2:"拜访",3:"线上"},executeResultList:{0:"没有收获",1:"加qq微信",2:"有意向",3:"签单"},newPageSize:10},l()(e,"listQuery",{page:0,pageSize:1,companyName:"",deptIds:[],userIds:[],companyType:[],executeStatus:[],executeType:[],executeResult:"",isComment:[],createTimeEnd:"",createTimeStart:"",executeTimeStart:"",executeTimeEnd:"",orderField:"",orderType:"",planDateEnd:"",planDateStart:"",projectBasis:"",provinceId:"",cityId:"",districtId:"",townId:""}),l()(e,"province_list",[]),l()(e,"city_list",[]),l()(e,"district_list",[]),l()(e,"town_list",[]),l()(e,"select_conditions_list",{}),l()(e,"tempListQuery",{}),l()(e,"executeSelectList",[]),l()(e,"isScreenShow",!1),l()(e,"companyList",[]),l()(e,"userList",[]),l()(e,"loginDate",[]),l()(e,"planDate",[]),l()(e,"actualDate",[]),l()(e,"pickerOptions",{shortcuts:[{text:"昨天",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-864e5),t.setTime(t.getTime()-864e5),e.$emit("pick",[a,t])}},{text:"今天",onClick:function(e){var t=new Date,a=new Date;e.$emit("pick",[a,t])}},{text:"上周",onClick:function(e){var t=new Date;t.setTime(t.getTime()-6048e5);var a=t.getDay(),n=new Date,o=new Date;0==a?(n.setDate(t.getDate()),o.setDate(t.getDate()+6)):(n.setTime(t.getTime()-864e5*a),o.setTime(t.getTime()+864e5*(6-a))),e.$emit("pick",[n,o])}},{text:"本周",onClick:function(e){var t=new Date,a=new Date,n=a.getDay(),o=a.getDate();0!=n&&a.setDate(o-n),e.$emit("pick",[a,t])}}]}),l()(e,"companyTypeList",[{num:"0",value:"已有客户"},{num:"1",value:"新开发"}]),l()(e,"executeStatusList",[{num:"1",value:"已实施　"},{num:"0",value:"未实施"}]),l()(e,"executeTypeDetail",[{num:"1",value:"电话联系 "},{num:"2",value:"上门拜访"},{num:"3",value:"线上"},{num:"0",value:"其他　　"}]),l()(e,"executeResultDetail",[{num:"0",value:"没有收获"},{num:"1",value:"加qq微信"},{num:"2",value:"有意向　"},{num:"3",value:"签单"}]),l()(e,"isCommentList",[{num:"0",value:"未评论　"},{num:"1",value:"已评论"}]),l()(e,"select_filter_list",{}),l()(e,"sortData",""),l()(e,"sortDataList",[{id:"createTime",value:"创建日期顺序",type:"ASC"},{id:"-createTime",value:"创建日期倒序",type:"DESC"},{id:"planDate",value:"计划实施日期顺序",type:"ASC"},{id:"-planDate",value:"计划实施日期倒序",type:"DESC"},{id:"executeTime",value:"实际实施日期顺序",type:"ASC"},{id:"-executeTime",value:"实际实施日期倒序",type:"DESC"}]),l()(e,"updateForm",{crmCompanyId:"",planDate:"",companyName:"",projectName:""}),l()(e,"updateVisible",!1),l()(e,"updatetitleName",null),l()(e,"isUserWriteChoose",!0),l()(e,"isProjectWriteChoose",!0),l()(e,"updateRules",{companyName:[{required:!0,message:"请填写或者选择目标客户",trigger:"blur"}],planDate:[{required:!0,message:"请选择计划实施日期",trigger:"blur"}],projectName:[{required:!0,message:"请填写或者选择推广项目",trigger:"blur"}],promotion_basis:[{required:!0,message:"请填写推广依据",trigger:"blur"}],projectBasis:[{required:!0,message:"请填写客户信息",trigger:"blur"}]}),l()(e,"companyNameList",[]),l()(e,"companyTotalList",null),l()(e,"projectWriteList",[]),l()(e,"timeDefaultShow",""),l()(e,"targetUserParam",{page:0,pageSize:10}),l()(e,"targetUserTotal",null),l()(e,"projectByParam",{page:0,pageSize:10}),l()(e,"projectByParamTotal",null),l()(e,"selectUserOrProject",null),l()(e,"isAgailCompanyId",""),l()(e,"addSaleDialogVisible",!1),l()(e,"addMoreSale",[]),l()(e,"saleIndex",""),l()(e,"implementVisible",!1),l()(e,"implementForm",{executeResult:[],executeTime:"",executeModalSelect:[]}),l()(e,"executeModalSelect",[]),l()(e,"implementRules",{executeTime:[{required:!0,message:"请选择实际实施时间",trigger:"blur"}],executeType:[{required:!0,message:"请选择实施类别",trigger:"blur"}],executeModalSelect:[{required:!0,message:"请选择实施效果",trigger:"blur"}]}),l()(e,"commentVisible",!1),l()(e,"commentForm",{}),l()(e,"commentRules",{commentRemark:[{required:!0,message:"请填写评论内容",trigger:"blur"}]}),l()(e,"exportShow",!1),l()(e,"exportFailShow",!1),l()(e,"exportSuccessShow",!1),l()(e,"exportFailMsg",{}),l()(e,"exportSuccessMsg",{}),l()(e,"salestotal",0),l()(e,"projectByParam",{page:0,pageSize:10}),l()(e,"allowGetList",this.authorityControl("SYSTEM:CUSTOMER:MANAGE","SYSTEM:SALEPLAN:MANAGE","SYSTEM:CUSTOMER:SALEPLAN:LIST")),l()(e,"allowGetImport",this.authorityControl("SYSTEM:CUSTOMER:MANAGE","SYSTEM:SALEPLAN:MANAGE","SYSTEM:CUSTOMER:SALEPLAN:GETIMPORT")),l()(e,"allowImport",this.authorityControl("SYSTEM:CUSTOMER:MANAGE","SYSTEM:SALEPLAN:MANAGE","SYSTEM:CUSTOMER:SALEPLAN:IMPORT")),l()(e,"allowExport",this.authorityControl("SYSTEM:CUSTOMER:MANAGE","SYSTEM:SALEPLAN:MANAGE","SYSTEM:CUSTOMER:SALEPLAN:EXPORT")),l()(e,"allowAdd",this.authorityControl("SYSTEM:CUSTOMER:MANAGE","SYSTEM:SALEPLAN:MANAGE","SYSTEM:CUSTOMER:SALEPLAN:INSERT")),l()(e,"allowUpdate",this.authorityControl("SYSTEM:CUSTOMER:MANAGE","SYSTEM:SALEPLAN:MANAGE","SYSTEM:CUSTOMER:SALEPLAN:UPDATE")),l()(e,"allowExecute",this.authorityControl("SYSTEM:CUSTOMER:MANAGE","SYSTEM:SALEPLAN:MANAGE","SYSTEM:CUSTOMER:SALEPLAN:EXECUTE")),l()(e,"allowAppraise",this.authorityControl("SYSTEM:CUSTOMER:MANAGE","SYSTEM:SALEPLAN:MANAGE","SYSTEM:CUSTOMER:SALEPLAN:APPRAISE")),l()(e,"allowDetails",this.authorityControl("SYSTEM:CUSTOMER:MANAGE","SYSTEM:SALEPLAN:MANAGE","SYSTEM:CUSTOMER:SALEPLAN:DETAILS")),l()(e,"allowDelete",this.authorityControl("SYSTEM:CUSTOMER:MANAGE","SYSTEM:SALEPLAN:MANAGE","SYSTEM:CUSTOMER:SALEPLAN:DELETE")),l()(e,"allowGetCompanyList",this.authorityControl("SYSTEM:CUSTOMER:MANAGE","SYSTEM:SALEPLAN:MANAGE","SYSTEM:CUSTOMER:SALEPLAN:COMPANY:LIST")),l()(e,"allowGetProjectList",this.authorityControl("SYSTEM:CUSTOMER:MANAGE","SYSTEM:SALEPLAN:MANAGE","SYSTEM:CUSTOMER:SALEPLAN:PROJECT:LIST")),l()(e,"allowGetPolicyProjectList",this.authorityControl("SYSTEM:CUSTOMER:MANAGE","SYSTEM:SALEPLAN:MANAGE","SYSTEM:CUSTOMER:SALEPLAN:POLICYPROJECT:LIST")),l()(e,"allowGetDeptList",this.authorityControl("SYSTEM:BACKGROUND:MANAGE","SYSTEM:DEPT:MANAGE","SYSTEM:DEPT:LIST")),e},mounted:function(){this.getPatentData()},activated:function(){this.getPatentData()},directives:{loadMore:{bind:function(e,t){e.querySelector(".el-select-dropdown .el-select-dropdown__wrap").addEventListener("scroll",function(){this.scrollHeight-this.scrollTop<=this.clientHeight&&t.value()})}}},methods:{loadMore:function(){var e=this;this.projectByParam.page+=10,Object(s.h)(this.projectByParam).then(function(t){if(200==t.code){if(e.projectWriteList.length>=t.data.total)return!1;e.projectWriteList=e.projectWriteList.concat(t.data.data)}})},addSaleRowHandle:function(){var e={companyName:"",contactName:"",contactPhone:"",planDate:this.updateForm.planDate,projectName:"",projectBasis:"",isSelectUser:!0,isSelectProject:!0,companyUserList:[]};this.addMoreSale.push(e)},switchMoreCompanyHandle:function(e){e.isSelectUser=!e.isSelectUser,e.companyName="",e.crmCompanyId=""},switchMoreProjectHandle:function(e){e.isSelectProject=!e.isSelectProject,e.projectName=""},addSelectMoreCompanyHandle:function(e,t){this.companyNameList.forEach(function(a){a.crmCompanyId==e&&(t.companyName=a.companyName)})},addSelectMoreProjectHandle:function(e,t){this.projectWriteList.forEach(function(a){a.projectId==e&&(t.projectName=a.projectName)})},delSaleMoreHandle:function(e){this.addMoreSale.splice(e,1)},setMoreSaleHandle:function(){var e=this;if(0!=this.addMoreSale.length){this.addMoreSale.forEach(function(t){if(t.crmCompanyId=e.crmCompanyId,t.companyName=e.companyNames,""==t.planDate||null==t.planDate)throw e.$message.warning("请选择计划实施时间"),new Error;if(""==t.projectName)throw e.$message.warning("请选择推广项目"),new Error;if(""==t.projectBasis)throw e.$message.warning("请输入客户信息"),new Error});var t=this.addMoreSale;Object(s.m)({salePlanDtos:t}).then(function(t){200===t.code&&(e.$message.success("新增成功"),e.addSaleDialogVisible=!1,e.addMoreSale=[],e.listQuery.page=0,e.getList())})}else this.$message.warning("请新增计划")},addListHandle:function(){this.updateForm={crmCompanyId:this.crmCompanyId,planDate:"",companyName:this.companyNames,projectName:""},this.targetUserParam.page=0,this.projectByParam.page=0,this.getTargetUserList(),this.getProjectData(),this.timeDefault();var e={companyName:"",contactName:"",contactPhone:"",planDate:this.updateForm.planDate,projectName:"",projectBasis:"",isSelectUser:!0,isSelectProject:!0,companyUserList:[]};this.addMoreSale=[],this.addMoreSale.push(e),this.addSaleDialogVisible=!0},goPlanDetail:function(e){this.allowDetails.twoAllow?this.$router.push({path:"/customer/salesPlanDetail",query:{id:e.planId}}):this.$message.warning("抱歉，您没有此权限")},editListHandle:function(e,t,a){var n=this;Object(s.j)({planId:e.planId}).then(function(e){n.updateForm={companyName:e.data.companyName,contactName:e.data.contactName,contactPhone:e.data.contactPhone,planDate:e.data.planDate,projectName:e.data.projectName,projectBasis:e.data.projectBasis,planId:e.data.planId,crmCompanyId:e.data.companyId},t?(n.updatetitleName=!0,n.timeDefault(),n.isAgailCompanyId=a.crmCompanyId):n.updatetitleName=!1}),this.getTargetUserList(),this.getProjectData(),this.updateVisible=!0},commentRemarkHandle:function(e){e.commentRemark&&(this.commentForm={},this.$set(this.commentForm,"commentRemark",e.commentRemark)),this.commentForm.planId=e.planId,this.commentVisible=!0},implementHandle:function(e){this.implementForm.executeModalSelect=[],this.$delete(this.implementForm,"executeModalSelect");var t=JSON.parse(o()(e));if(1==e.executeStatus)this.implementForm={executeTime:t.executeTime,executeType:o()(t.executeType),executeContent:t.executeContent,planId:t.planId,executeResult:t.executeResult},this.$set(this.implementForm,"executeModalSelect",t.executeResult.split(","));else{var a=new Date,n=a.getFullYear()+"-"+(a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"-"+(a.getDate()<10?"0"+a.getDate():a.getDate())+" "+(a.getHours()<10?"0"+a.getHours():a.getHours())+":"+(a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes())+":"+(a.getSeconds()<10?"0"+a.getSeconds():a.getSeconds());this.implementForm={executeTime:n,executeResult:[],planId:t.planId,executeModalSelect:[]}}this.implementVisible=!0},addSelectCompanyHandle:function(e){var t=this;this.selectUserOrProject="user",this.companyNameList.forEach(function(a){a.crmCompanyId==e&&(t.updateForm.companyName=a.companyName,t.updateForm.crmCompanyId=a.crmCompanyId)})},addSelectProjectHandle:function(e){var t=this;this.selectUserOrProject="project",this.projectWriteList.forEach(function(a){a.projectId==e&&(t.updateForm.projectName=a.projectName)})},setUpdateFormHandle:function(){var e=this;this.$refs.updateForm.validate(function(t,a){if(!t)return e.callbackError(a),!1;""!==e.isAgailCompanyId&&(e.updateForm.crmCompanyId=e.isAgailCompanyId),Object(s.m)({salePlanDtos:[e.updateForm]}).then(function(t){200===t.code&&(e.$message.success("操作成功"),e.updateVisible=!1,e.isAgailCompanyId="",e.allowGetList.twoAllow?(e.listQuery.page=0,e.getList()):e.$message.warning("抱歉，您没有此权限"))})})},setChangeFormHandle:function(){var e=this;this.$refs.updateForm.validate(function(t,a){if(!t)return e.callbackError(a),!1;Object(s.o)(e.updateForm).then(function(t){200===t.code&&(e.$message.success("操作成功"),e.updateVisible=!1,e.allowGetList.twoAllow?(e.listQuery.page=0,e.getList()):e.$message.warning("抱歉，您没有此权限"))})})},switchCompanyHandle:function(){this.isUserWriteChoose=!this.isUserWriteChoose,this.updateForm.companyName=""},switchProjectHandle:function(){this.isProjectWriteChoose=!this.isProjectWriteChoose,this.updateForm.projectName=""},timeDefault:function(){var e=new Date((new Date).getTime()+864e5),t=e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate());this.updateForm.planDate=JSON.parse(o()(t))},cananlUpdate:function(){this.updateVisible=!1,this.updateForm={planDate:"",companyName:"",projectName:""},this.timeDefault()},getTargetUserList:function(){var e=this;this.allowGetCompanyList.twoAllow?Object(s.i)(this.targetUserParam).then(function(t){200===t.code&&(e.companyNameList=t.data.data,e.companyTotalList=t.data.total)}):this.$message.warning("抱歉，您没有权限获取企业列表")},getProjectData:function(){var e=this;this.allowGetProjectList.twoAllow?Object(s.h)(this.projectByParam).then(function(t){200===t.code&&(e.projectWriteList=t.data.data)}):this.$message.warning("抱歉，您没有权限获取项目列表")},handleSelectData:function(e){this.selectUserOrProject=e},handleMoreSelectData:function(e,t,a){var n=this;this.selectUserOrProject=t,this.saleIndex=a,this.getTargetUserList(),setTimeout(function(){e.companyUserList=n.companyNameList},500)},setCommentHandle:function(){var e=this;this.$refs.commentForm.validate(function(t,a){if(!t)return e.callbackError(a),!1;Object(s.n)(e.commentForm).then(function(t){200===t.code&&(e.commentForm={},e.$message.success("操作成功"),e.commentVisible=!1,e.allowGetList.twoAllow?(e.listQuery.page=0,e.getList()):e.$message.warning("抱歉，您没有此权限"))})})},cananlCommentHandle:function(){this.commentForm={},this.commentVisible=!1},setImplementFormHandle:function(){var e=this;this.$refs.implementForm.validate(function(t,a){if(!t)return e.callbackError(a),!1;0!=e.implementForm.executeModalSelect.length?(e.implementForm.executeResult=e.implementForm.executeModalSelect.join(","),Object(s.p)(e.implementForm).then(function(t){200===t.code&&(e.implementForm={executeResult:[],executeModalSelect:[]},e.$message.success("操作成功"),e.implementVisible=!1,e.allowGetList.twoAllow?(e.listQuery.page=0,e.getList()):e.$message.warning("抱歉，您没有此权限"))})):e.$message.warning("请选择实施效果")})},cananlImplementForm:function(){this.implementForm={executeResult:[],executeModalSelect:[]},this.implementVisible=!1},callbackError:function(e){for(var t in e){this.tempArr=e[t];break}this.$message({type:"error",message:this.tempArr[0].message})},getPatentData:function(){""!=this.crmCompanyId&&this.getList()},newLoadMore:function(){this.newPageSize=this.newPageSize+10},getList:function(){var e=this;this.listQuery.crmCompanyId=this.crmCompanyId,this.listQuery.pageSize=1e4,Object(s.k)(this.listQuery).then(function(t){e.salePlanBos=t.data.data[0].salePlanBos,e.salestotal=t.data.data[0].salePlanBos.length,e.$emit("salesTotal",t.data.data[0].salePlanBos.length)})}}}),c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sales-plan-box"},[a("div",{staticClass:"list"},[a("div",{staticClass:"class-newPlan",on:{click:function(t){return e.addListHandle(e.item)}}},[e._v("新增计划")]),e._v(" "),e._l(e.salePlanBos.slice(0,e.newPageSize),function(t,n){return a("div",{key:n,staticClass:"user-conent"},[a("div",{staticClass:"index"},[e._v("\n                  "+e._s(n+1)+"\n                ")]),e._v(" "),a("div",{staticClass:"main-list"},[a("div",{staticClass:"item"},[a("div",{staticClass:"cate",staticStyle:{overflow:"inherit"}},[e._v("\n                      业务员："),a("span",{staticClass:"blue"},[e._v(e._s(t.userName))]),e._v(" "),1===t.companyType?a("img",{staticStyle:{"margin-left":"6px","margin-top":"-2px"},attrs:{src:e.newly}}):e._e(),e._v(" "),0===t.companyType?a("img",{staticStyle:{"margin-left":"6px","margin-top":"-2px"},attrs:{src:e.existing}}):e._e()]),e._v(" "),a("div",{staticClass:"cate"},[a("div",[e._v("创建日期：")]),e._v(" "),a("span",[e._v(e._s(t.createTime))])]),e._v(" "),a("div",{staticClass:"cate"},[e._v("联系人："),a("span",{staticStyle:{"max-width":"200px"},attrs:{title:t.contactName}},[e._v(e._s(t.contactName))])]),e._v(" "),a("div",{staticClass:"cate"},[e._v("联系电话："),a("span",{staticStyle:{"max-width":"200px"},attrs:{title:t.contactPhone}},[e._v(e._s(t.contactPhone))])])]),e._v(" "),a("div",{staticClass:"item"},[a("div",{staticClass:"cate"},[e._v("计划实施时间："),a("span",[e._v(e._s(t.planDate))])]),e._v(" "),a("div",{staticClass:"cate"},[e._v("推广项目：\n                      "),t.newProjectName?a("span",{staticClass:"blue",staticStyle:{display:"inline-block",width:"200px","text-overflow":"ellipsis",overflow:"hidden"},attrs:{title:t.newProjectName}},[e._v(e._s(t.newProjectName))]):a("span",{staticClass:"blue",staticStyle:{display:"inline-block",width:"200px","text-overflow":"ellipsis",overflow:"hidden"},attrs:{title:t.projectName}},[e._v(e._s(t.projectName))])]),e._v(" "),a("div",{staticClass:"cate"},[a("div",[e._v("推广依据：")]),e._v(" "),a("span",{staticStyle:{display:"inline-block",width:"200px","text-overflow":"ellipsis",overflow:"hidden"},attrs:{title:t.projectBasis}},[e._v(e._s(t.projectBasis))])])]),e._v(" "),1==t.executeStatus?a("div",{staticClass:"item"},[a("div",{staticClass:"cate"},[e._v("实际实施时间："),a("span",[e._v(e._s(t.executeTime))])]),e._v(" "),a("div",{staticClass:"cate"},[e._v("实施类别："),a("span",{staticClass:"blue"},[e._v(e._s(e.executeTypeList[t.executeType]))])]),e._v(" "),a("div",{staticClass:"cate"},[e._v("实施效果：\n                      "),e._l(t.executeResult,function(t,n){return a("span",{attrs:{title:e.executeResultList[t]}},[e._v("\n                        "+e._s(e.executeResultList[t])+" \n                      ")])})],2),e._v(" "),a("div",{staticClass:"cate results"},[a("i",{staticClass:"tit"},[e._v("实施结果：")]),a("span",{attrs:{title:t.executeContent}},[e._v(e._s(t.executeContent))])])]):e._e(),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.executeTime&&t.commentRemark,expression:"list.executeTime && list.commentRemark"}],staticClass:"item"},[a("div",{staticClass:"cate results"},[a("i",{staticClass:"tit"},[e._v("评论：")]),a("span",{attrs:{title:t.commentRemark}},[e._v(e._s(t.commentRemark))])])])]),e._v(" "),a("div",{staticClass:"bage-btn-handle"},[a("div",{staticClass:"bage"},[1!==t.executeStatus?a("img",{attrs:{src:e.unenforced}}):e._e()]),e._v(" "),a("div",{staticClass:"handle-btn-group"},[e.allowDetails.twoAllow?a("div",{staticClass:"item-btn read",on:{click:function(a){return e.goPlanDetail(t)}}}):e._e(),e._v(" "),e.allowExecute.twoAllow&&1!==t.executeStatus?a("div",{staticClass:"item-btn implement",on:{click:function(a){return e.implementHandle(t)}}}):e._e(),e._v(" "),1==t.executeStatus&&e.allowUpdate.twoAllow?a("div",{staticClass:"item-btn again",on:{click:function(a){return e.editListHandle(t,!0,e.item)}}},[e._v("再次计划\n                    ")]):e._e(),e._v(" "),1!==t.executeStatus&&e.allowUpdate.twoAllow?a("div",{staticClass:"item-btn edit",on:{click:function(a){return e.editListHandle(t,!1)}}}):e._e(),e._v(" "),1==t.executeStatus&&e.allowAppraise.twoAllow?a("div",{staticClass:"item-btn remark",on:{click:function(a){return e.commentRemarkHandle(t)}}}):e._e()])])])}),e._v(" "),e.salePlanBos.length<=e.newPageSize?a("div",{staticClass:"get-more"},[e._v("\n          没有更多\n        ")]):a("div",{staticClass:"get-more",on:{click:e.newLoadMore}},[e._v("\n          加载更多\n        ")])],2),e._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"editorUserModal",attrs:{"close-on-click-modal":!1,title:e.updatetitleName?"新增计划":"变更",visible:e.updateVisible,width:"600px"},on:{"update:visible":function(t){e.updateVisible=t}}},[a("el-form",{ref:"updateForm",attrs:{model:e.updateForm,rules:e.updateRules,"label-width":"120px"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"目标客户：",prop:"companyNames"}},[a("el-input",{staticClass:"user-input",attrs:{placeholder:"请输入目标客户",disabled:!0},model:{value:e.updateForm.companyName,callback:function(t){e.$set(e.updateForm,"companyName",t)},expression:"updateForm.companyName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系人："}},[a("el-input",{staticClass:"user-input",attrs:{maxlength:"50"},model:{value:e.updateForm.contactName,callback:function(t){e.$set(e.updateForm,"contactName",t)},expression:"updateForm.contactName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系电话："}},[a("el-input",{staticClass:"user-input",attrs:{maxlength:"50"},model:{value:e.updateForm.contactPhone,callback:function(t){e.$set(e.updateForm,"contactPhone",t)},expression:"updateForm.contactPhone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"计划实施日期：",prop:"planDate"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.updateForm.planDate,callback:function(t){e.$set(e.updateForm,"planDate",t)},expression:"updateForm.planDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"推广项目：",prop:"projectName"}},[e.isProjectWriteChoose?a("el-select",{directives:[{name:"loadMore",rawName:"v-loadMore",value:e.loadMore,expression:"loadMore"}],staticClass:"user-select",staticStyle:{width:"250px"},attrs:{filterable:"",clearable:"",placeholder:"选择推广项目",remote:"","remote-method":e.remoteProject},on:{change:e.addSelectProjectHandle,focus:function(t){return e.handleSelectData("project")},blur:e.handleSelectProjectBlue},model:{value:e.updateForm.projectName,callback:function(t){e.$set(e.updateForm,"projectName",t)},expression:"updateForm.projectName"}},e._l(e.projectWriteList,function(e,t){return a("el-option",{key:t,attrs:{label:e.projectName,value:e.projectId}})}),1):a("el-input",{staticClass:"user-input",attrs:{maxlength:"50",placeholder:"请输入推广项目"},model:{value:e.updateForm.projectName,callback:function(t){e.$set(e.updateForm,"projectName",t)},expression:"updateForm.projectName"}}),e._v(" "),a("el-button",{staticClass:"switch-btn",on:{click:e.switchProjectHandle}},[e._v("\n            "+e._s(e.isProjectWriteChoose?"切换为输入":"切换为选择")+"\n          ")])],1),e._v(" "),a("el-form-item",{attrs:{label:"客户信息：",prop:"projectBasis"}},[a("el-input",{attrs:{maxlength:"1000",type:"textarea",resize:"none",rows:5,placeholder:"客户的什么信息，让你去推广该项目，请提前做好准备"},model:{value:e.updateForm.projectBasis,callback:function(t){e.$set(e.updateForm,"projectBasis",t)},expression:"updateForm.projectBasis"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.updatetitleName?a("el-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick"}],staticClass:"setBtn",on:{click:e.setUpdateFormHandle}},[e._v("确 定")]):a("el-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick"}],staticClass:"setBtn",on:{click:e.setChangeFormHandle}},[e._v("确 定")]),e._v(" "),a("el-button",{staticClass:"cananl",on:{click:e.cananlUpdate}},[e._v("取 消")])],1)],1),e._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"editorUserModal",attrs:{title:"实施",visible:e.implementVisible,width:"600px"},on:{"update:visible":function(t){e.implementVisible=t}}},[a("el-form",{ref:"implementForm",attrs:{model:e.implementForm,rules:e.implementRules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"实际实施时间:",prop:"executeTime"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择时间","value-format":"yyyy-MM-dd HH:mm:ss","default-value":e.implementForm.executeTime},model:{value:e.implementForm.executeTime,callback:function(t){e.$set(e.implementForm,"executeTime",t)},expression:"implementForm.executeTime"}})],1),e._v(" "),a("el-form-item",{staticClass:"modal-radio",attrs:{label:"实施类别：",prop:"executeType"}},[a("el-radio-group",{model:{value:e.implementForm.executeType,callback:function(t){e.$set(e.implementForm,"executeType",t)},expression:"implementForm.executeType"}},e._l(e.executeTypeDetail,function(t){return a("el-radio",{key:t.num,attrs:{label:t.num}},[e._v("\n              "+e._s(t.value)+"\n            ")])}),1)],1),e._v(" "),a("el-form-item",{staticClass:"modal-radio",attrs:{label:"实施效果：",prop:"executeModalSelect"}},[a("el-checkbox-group",{model:{value:e.implementForm.executeModalSelect,callback:function(t){e.$set(e.implementForm,"executeModalSelect",t)},expression:"implementForm.executeModalSelect"}},e._l(e.executeResultDetail,function(t){return a("el-checkbox",{key:t.num,attrs:{label:t.num}},[e._v("\n              "+e._s(t.value)+"\n            ")])}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"实施结果："}},[a("el-input",{attrs:{type:"textarea",resize:"none",rows:5,placeholder:"请输入实施结果"},model:{value:e.implementForm.executeContent,callback:function(t){e.$set(e.implementForm,"executeContent",t)},expression:"implementForm.executeContent"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick"}],staticClass:"setBtn",on:{click:e.setImplementFormHandle}},[e._v("确 定")]),e._v(" "),a("el-button",{staticClass:"cananl",on:{click:e.cananlImplementForm}},[e._v("取 消")])],1)],1),e._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"editorUserModal",attrs:{title:"评论",visible:e.commentVisible,width:"600px"},on:{"update:visible":function(t){e.commentVisible=t}}},[a("el-form",{ref:"commentForm",attrs:{model:e.commentForm,rules:e.commentRules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"评论：",prop:"commentRemark"}},[a("el-input",{attrs:{type:"textarea",resize:"none",rows:5,placeholder:"请输入评论"},model:{value:e.commentForm.commentRemark,callback:function(t){e.$set(e.commentForm,"commentRemark",t)},expression:"commentForm.commentRemark"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick"}],staticClass:"setBtn",on:{click:e.setCommentHandle}},[e._v("确 定")]),e._v(" "),a("el-button",{staticClass:"cananl",on:{click:e.cananlCommentHandle}},[e._v("取 消")])],1)],1),e._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"add-sale-modal",attrs:{"before-close":e.cananlMoreSaleHandle,title:"新增计划",visible:e.addSaleDialogVisible,width:"1200px"},on:{"update:visible":function(t){e.addSaleDialogVisible=t}}},[a("el-button",{staticStyle:{"margin-bottom":"10px",float:"right"},attrs:{type:"primary",size:"medium"},on:{click:e.addSaleRowHandle}},[e._v("新增一行\n      ")]),e._v(" "),a("el-table",{staticClass:"add-sale-table",attrs:{"header-cell-class-name":e.must,data:e.addMoreSale,border:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"目标客户",prop:"userName"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{placeholder:"请输入内容",disabled:!0},model:{value:e.companyNames,callback:function(t){e.companyNames=t},expression:"companyNames"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"150",align:"center",label:"联系人",prop:"userName"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{staticClass:"user-input",attrs:{maxlength:"50"},model:{value:t.row.contactName,callback:function(a){e.$set(t.row,"contactName",a)},expression:"scope.row.contactName"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"150",align:"center",label:"联系电话",prop:"userName"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{staticClass:"user-input",attrs:{maxlength:"50"},model:{value:t.row.contactPhone,callback:function(a){e.$set(t.row,"contactPhone",a)},expression:"scope.row.contactPhone"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"160",align:"center",label:"计划实施时间",prop:"userName"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:t.row.planDate,callback:function(a){e.$set(t.row,"planDate",a)},expression:"scope.row.planDate"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"推广项目",prop:"userName"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"flex-center"},[t.row.isSelectProject?a("el-select",{directives:[{name:"loadMore",rawName:"v-loadMore",value:e.loadMore,expression:"loadMore"}],staticClass:"user-select",attrs:{filterable:"",clearable:"",placeholder:"选择推广项目",remote:"","remote-method":e.remoteProject},on:{change:function(a){return e.addSelectMoreProjectHandle(a,t.row)},focus:function(t){return e.handleSelectData("project")},blur:e.handleSelectProjectBlue},model:{value:t.row.projectName,callback:function(a){e.$set(t.row,"projectName",a)},expression:"scope.row.projectName"}},e._l(e.projectWriteList,function(e,t){return a("el-option",{key:t,attrs:{label:e.projectName,value:e.projectId}})}),1):a("el-input",{staticClass:"user-input",attrs:{placeholder:"请输入推广项目",maxlength:"50"},model:{value:t.row.projectName,callback:function(a){e.$set(t.row,"projectName",a)},expression:"scope.row.projectName"}}),e._v(" "),t.row.isSelectProject?a("i",{staticClass:"el-icon-edit",attrs:{title:"输入项目"},on:{click:function(a){return e.switchMoreProjectHandle(t.row)}}}):a("i",{staticClass:"el-icon-s-operation",attrs:{title:"选择项目"},on:{click:function(a){return e.switchMoreProjectHandle(t.row)}}})],1)]}}])},[a("span",{staticClass:"star",staticStyle:{"margin-left":"-2px","margin-top":"28px",left:"50%"}},[e._v("*")])]),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"客户信息",prop:"userName"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{maxlength:"1000",type:"textarea",resize:"none",rows:5,placeholder:"客户的什么信息，让你去推广该项目，请提前做好准备"},model:{value:t.row.projectBasis,callback:function(a){e.$set(t.row,"projectBasis",a)},expression:"scope.row.projectBasis"}})]}}])},[a("span",{staticClass:"star",staticStyle:{"margin-left":"50px","margin-top":"28px",left:"50%"}},[e._v("*")])]),e._v(" "),a("el-table-column",{attrs:{width:"35",align:"center",label:"操作","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"icon-sale-del el-icon-delete",on:{click:function(a){return e.delSaleMoreHandle(t.$index)}}})]}}])})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"medium"},on:{click:function(t){e.addSaleDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.setMoreSaleHandle}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var m=a("VU/8")(r,c,!1,function(e){a("XHd2")},"data-v-198e906b",null);t.default=m.exports}});